CWE ID,File Name,Line #,Vulnerability Description,Potential Impact/Exploitation,Severity,Remediation Applied
CWE-89,vulnerable_script.php,109,Unparameterized query using $_GET['search'] leading to SQL injection,Data leak / unauthorized DB access,Critical,Converted to prepared statements with bound params
CWE-79,vulnerable_script.php,84,Stored XSS via unsanitized profile bio,Stored XSS -> session hijack / malware delivery,High,Sanitized inputs and HTML-escaped outputs
CWE-434,vulnerable_script.php,93,Unrestricted file upload allowing executable files,RCE via uploaded webshell,Critical,Whitelist file extensions, size limit, store outside webroot
CWE-78,vulnerable_script.php,127,Use of shell_exec on user input (exec_command),OS command injection -> full system compromise,Critical,Removed arbitrary execution; command whitelist
CWE-22,vulnerable_script.php,131,Log file path taken from user (path traversal),Disclosure of arbitrary files / info leak,High,Restricted to LOG_PATH; basename/realpath checks
CWE-384,vulnerable_script.php,178,Accepting session_id from GET (session fixation),Session hijacking,High,Removed session_id() usage; regenerate session on login
CWE-327,vulnerable_script.php,41,Weak hashing using md5 for passwords,Credentials easily cracked/compromised,High,Replaced with password_hash/password_verify
CWE-117,vulnerable_script.php,101,Logging raw filename and username (log injection),Log forging / misleading logs,Medium,Use logger and sanitize log inputs
CWE-611,vulnerable_script.php,151,XML parsing with LIBXML_NOENT|LIBXML_DTDLOAD (XXE enabled),Read local files / SSRF / sensitive data exposure,Critical,Disabled external entity expansion (LIBXML_NONET)
CWE-798,vulnerable_script.php,7,Hard-coded ADMIN_TOKEN in source,Token disclosure / bypass,High,Removed token bypass; enforce session role checks
CWE-304,vulnerable_script.py,25,Hardcoded app.secret_key and admin token,Session tampering / credential theft,High,Loaded secret from env or generated securely
CWE-327,vulnerable_script.py,89,MD5 used for password hashing (weak),Passwords cracked via rainbow tables,High,Replaced with werkzeug.generate_password_hash (PBKDF2)
CWE-79,vulnerable_script.py,117,Reflected XSS by echoing request.args['name'] unescaped,Reflected XSS -> cookie theft,High,Escape/encode output with markupsafe.escape
CWE-78,vulnerable_script.py,306,subprocess.check_output(command, shell=True) with user cmd,OS Command Injection -> RCE,Critical,Removed shell=True; whitelist commands and pass args as list
CWE-502,vulnerable_script.py,409,pickle.loads on user-supplied data (insecure deserialization),Remote code execution / system compromise,Critical,Reject pickle; use JSON deserialization
CWE-611,vulnerable_script.py,371,xml.etree.ElementTree used directly (XXE risk),Local file disclosure / XXE,High,Replaced with defusedxml (safe_fromstring)
CWE-434,vulnerable_script.py,286,No validation on uploaded files (and logging of filenames),Upload of webshells/corrupt files,Critical,secure_filename, extension whitelist, size limit, store outside webroot
CWE-22,vulnerable_script.py,383,filename from query used to read files (path traversal),Arbitrary file read / information disclosure,High,Use DB mapping and secure path checks
CWE-287,vulnerable_script.py,298,Admin access based on GET token rather than session,Privilege bypass / unauthorized admin actions,Critical,Require session role == 'admin' and authentication
CWE-384,vulnerable_script.py,170,Session fixation: session not regenerated on login,Attacker can hijack session,High,Clear session and regenerate on login
CWE-117,vulnerable_script.py,286,Direct file write to logs using user-supplied values (log injection),Log forging / obfuscation,Medium,Use logger.info with parameterized logging
CWE-759,vulnerable_script.py,128-171,Unsalted/weak hashes stored in DB,Credential reuse/cracking,High,Applied salted, strong PBKDF2 hashes via werkzeug
CWE-307,vulnerable_script.py,170-190,No brute-force protection on login (excessive attempts allowed),Account brute-force and credential stuffing,Medium,Recommend rate-limit login attempts (not implemented in lab)
